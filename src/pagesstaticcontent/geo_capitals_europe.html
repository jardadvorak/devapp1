<!DOCTYPE html>
<html lang="cs">
<head>
    <meta charset="UTF-8">
    <title>Kv√≠z - Evropsk√° hlavn√≠ mƒõsta</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 20px auto;
            padding: 0 20px;
        }
        .hidden { display: none; }
        .question {
            margin: 20px 0;
            padding: 15px;
            background: #f5f5f5;
            border-radius: 5px;
        }
        .options {
            margin: 10px 0;
        }
        .option {
            display: block;
            margin: 8px 0;
            cursor: pointer;
            padding: 8px;
            background: #fff;
            border: 2px solid #ddd;
            border-radius: 4px;
            transition: all 0.2s;
        }
        .option:hover {
            background: #f0f8ff;
            border-color: #007bff;
        }
        .option input {
            margin-right: 8px;
        }
        button {
            padding: 10px 20px;
            background: #007bff;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }
        button:hover {
            background: #0056b3;
        }
        .feedback {
            margin: 10px 0;
            padding: 10px;
            border-radius: 5px;
        }
        .feedback.correct {
            background: #d4edda;
            color: #155724;
        }
        .feedback.incorrect {
            background: #f8d7da;
            color: #721c24;
        }
        .stats {
            margin: 10px 0;
            font-style: italic;
        }
        .results {
            margin-top: 20px;
        }
        .country-name {
            font-weight: bold;
            color: #2c5aa0;
        }
    </style>
</head>
<body>
    <div id="intro" class="intro">
        <h1>Kv√≠z - Evropsk√° hlavn√≠ mƒõsta</h1>
        <h2 id="quizDateTime"></h2>
        <p>V tomto kv√≠zu si otestujete znalost hlavn√≠ch mƒõst evropsk√Ωch zem√≠.</p>
        <p>Pro ka≈ædou ot√°zku vyberte spr√°vnou odpovƒõƒè ze ƒçty≈ô mo≈ænost√≠.</p>
        <p><strong>V ka≈æd√©m kole se n√°hodnƒõ vybere 10 zem√≠ ze v≈°ech evropsk√Ωch zem√≠.</strong></p>
        <button onclick="startQuiz()">Zaƒç√≠t kv√≠z</button>
    </div>

    <div id="quizMode" class="hidden">
        <h2>Vyberte typ kv√≠zu</h2>
        <div style="margin: 20px 0;">
            <label class="option" style="display: block; margin: 10px 0;">
                <input type="radio" name="quizType" value="countryToCapital" checked>
                <strong>Zemƒõ ‚Üí Hlavn√≠ mƒõsto</strong><br>
                <small style="margin-left: 24px; color: #666;">Uk√°≈æe se zemƒõ, vyb√≠r√°te hlavn√≠ mƒõsto</small>
            </label>
            <label class="option" style="display: block; margin: 10px 0;">
                <input type="radio" name="quizType" value="capitalToCountry">
                <strong>Hlavn√≠ mƒõsto ‚Üí Zemƒõ</strong><br>
                <small style="margin-left: 24px; color: #666;">Uk√°≈æe se hlavn√≠ mƒõsto, vyb√≠r√°te zemi</small>
            </label>
        </div>
        <button onclick="startSelectedQuiz()">Pokraƒçovat</button>
        <button onclick="goBackToIntro()" style="background: #6c757d; margin-left: 10px;">Zpƒõt</button>
    </div>

    <div id="quiz" class="hidden">
        <div id="question" class="question"></div>
        <div class="feedback hidden"></div>
        <div class="stats hidden"></div>
        <button onclick="checkAnswer()">Potvrdit odpovƒõƒè</button>
    </div>

    <div id="results" class="hidden results">
        <h2>V√Ωsledky kv√≠zu</h2>
        <h3 id="resultsDateTime"></h3>
        <div id="finalStats"></div>
        <button onclick="restartQuiz()" style="margin-top: 15px; background: #28a745;">Hr√°t znovu</button>
    </div>

    <script>
        // V≈°echny evropsk√© zemƒõ a jejich hlavn√≠ mƒõsta
        const europeanCountries = [
            { country: "Alb√°nie", capital: "Tirana" },
            { country: "Andorra", capital: "Andorra la Vella" },
            { country: "Arm√©nie", capital: "Jerevan" },
            { country: "Rakousko", capital: "V√≠de≈à" },
            { country: "√Åzerb√°jd≈æ√°n", capital: "Baku" },
            { country: "Bƒõlorusko", capital: "Minsk" },
            { country: "Belgie", capital: "Brusel" },
            { country: "Bosna a Hercegovina", capital: "Sarajevo" },
            { country: "Bulharsko", capital: "Sofie" },
            { country: "Chorvatsko", capital: "Z√°hreb" },
            { country: "Kypr", capital: "Nik√≥sie" },
            { country: "ƒåesk√° republika", capital: "Praha" },
            { country: "D√°nsko", capital: "Koda≈à" },
            { country: "Estonsko", capital: "Tallinn" },
            { country: "Finsko", capital: "Helsinki" },
            { country: "Francie", capital: "Pa≈ô√≠≈æ" },
            { country: "Gruzie", capital: "Tbilisi" },
            { country: "Nƒõmecko", capital: "Berl√≠n" },
            { country: "≈òecko", capital: "Ath√©ny" },
            { country: "Maƒèarsko", capital: "Budape≈°≈•" },
            { country: "Island", capital: "Reykjav√≠k" },
            { country: "Irsko", capital: "Dublin" },
            { country: "It√°lie", capital: "≈ò√≠m" },
            { country: "Kazachst√°n", capital: "Nur-Sultan" },
            { country: "Kosovo", capital: "Pri≈°tina" },
            { country: "Loty≈°sko", capital: "Riga" },
            { country: "Lichten≈°tejnsko", capital: "Vaduz" },
            { country: "Litva", capital: "Vilnius" },
            { country: "Lucembursko", capital: "Lucemburk" },
            { country: "Malta", capital: "Valletta" },
            { country: "Moldavsko", capital: "Ki≈°inƒõv" },
            { country: "Monako", capital: "Monaco" },
            { country: "ƒåern√° Hora", capital: "Podgorica" },
            { country: "Nizozemsko", capital: "Amsterdam" },
            { country: "Severn√≠ Makedonie", capital: "Skopje" },
            { country: "Norsko", capital: "Oslo" },
            { country: "Polsko", capital: "Var≈°ava" },
            { country: "Portugalsko", capital: "Lisabon" },
            { country: "Rumunsko", capital: "Bukure≈°≈•" },
            { country: "Rusko", capital: "Moskva" },
            { country: "San Marino", capital: "San Marino" },
            { country: "Srbsko", capital: "Bƒõlehrad" },
            { country: "Slovensko", capital: "Bratislava" },
            { country: "Slovinsko", capital: "Lubla≈à" },
            { country: "≈†panƒõlsko", capital: "Madrid" },
            { country: "≈†v√©dsko", capital: "Stockholm" },
            { country: "≈†v√Ωcarsko", capital: "Bern" },
            { country: "Turecko", capital: "Ankara" },
            { country: "Ukrajina", capital: "Kyjev" },
            { country: "Spojen√© kr√°lovstv√≠", capital: "Lond√Ωn" },
            { country: "Vatik√°n", capital: "Vatik√°n" }
        ];

        let selectedQuestions = [];
        let currentQuestion = 0;
        let correctAnswers = 0;
        let startTime;
        let quizMode = 'countryToCapital'; // 'countryToCapital' nebo 'capitalToCountry'

        function shuffle(array) {
            const newArray = [...array];
            for (let i = newArray.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [newArray[i], newArray[j]] = [newArray[j], newArray[i]];
            }
            return newArray;
        }

        function generateWrongAnswers(correctAnswer, allCountries, mode) {
            let wrongAnswers;
            if (mode === 'countryToCapital') {
                wrongAnswers = allCountries
                    .filter(country => country.capital !== correctAnswer)
                    .map(country => country.capital);
            } else {
                wrongAnswers = allCountries
                    .filter(country => country.country !== correctAnswer)
                    .map(country => country.country);
            }
            
            return shuffle(wrongAnswers).slice(0, 3);
        }

        function prepareQuestions() {
            // Vybrat 10 n√°hodn√Ωch zem√≠
            const shuffledCountries = shuffle(europeanCountries);
            const selectedCountries = shuffledCountries.slice(0, 10);
            
            selectedQuestions = selectedCountries.map(country => {
                try {
                    if (quizMode === 'countryToCapital') {
                        const wrongAnswers = generateWrongAnswers(country.capital, europeanCountries, 'countryToCapital');
                        const allOptions = shuffle([country.capital, ...wrongAnswers]);
                        
                        return {
                            text: `Jak√© je hlavn√≠ mƒõsto zemƒõ <span class="country-name">${country.country}</span>?`,
                            options: allOptions,
                            correct: country.capital,
                            country: country.country
                        };
                    } else {
                        const wrongAnswers = generateWrongAnswers(country.country, europeanCountries, 'capitalToCountry');
                        const allOptions = shuffle([country.country, ...wrongAnswers]);
                        
                        return {
                            text: `Kter√© zemƒõ je hlavn√≠m mƒõstem <span class="country-name">${country.capital}</span>?`,
                            options: allOptions,
                            correct: country.country,
                            capital: country.capital
                        };
                    }
                } catch (error) {
                    console.error('Chyba p≈ôi vytv√°≈ôen√≠ ot√°zky pro zemi:', country, error);
                    return null;
                }
            }).filter(question => question !== null); // Odfiltrovat neplatn√© ot√°zky
            
            console.log('P≈ôipraveno ot√°zek:', selectedQuestions.length);
        }

        function startQuiz() {
            document.getElementById('intro').classList.add('hidden');
            document.getElementById('quizMode').classList.remove('hidden');
        }

        function startSelectedQuiz() {
            const selectedMode = document.querySelector('input[name="quizType"]:checked');
            if (!selectedMode) {
                alert('Pros√≠m vyberte typ kv√≠zu');
                return;
            }
            
            quizMode = selectedMode.value;
            
            document.getElementById('quizMode').classList.add('hidden');
            document.getElementById('quiz').classList.remove('hidden');
            document.getElementById('quizDateTime').textContent = new Date().toLocaleString('cs-CZ');
            startTime = new Date();
            currentQuestion = 0;
            correctAnswers = 0;
            
            prepareQuestions();
            
            // Kontrola, zda se poda≈ôilo p≈ôipravit ot√°zky
            if (selectedQuestions.length === 0) {
                alert('Chyba p≈ôi p≈ô√≠pravƒõ ot√°zek. Zkuste to znovu.');
                goBackToIntro();
                return;
            }
            
            showQuestion();
        }

        function goBackToIntro() {
            document.getElementById('quizMode').classList.add('hidden');
            document.getElementById('intro').classList.remove('hidden');
        }

        function showQuestion() {
            // Kontrola, zda m√°me platnou ot√°zku
            if (currentQuestion >= selectedQuestions.length || !selectedQuestions[currentQuestion]) {
                console.error('Neplatn√Ω index ot√°zky:', currentQuestion);
                showResults();
                return;
            }
            
            const questionDiv = document.getElementById('question');
            const question = selectedQuestions[currentQuestion];
            
            const optionsHtml = question.options.map(option => 
                `<label class="option"><input type="radio" name="answer" value="${option}"> ${option}</label>`
            ).join('');

            questionDiv.innerHTML = `
                <p>Ot√°zka ${currentQuestion + 1} z ${selectedQuestions.length}</p>
                <p>${question.text}</p>
                <div class="options">${optionsHtml}</div>
            `;

            document.querySelector('.feedback').classList.add('hidden');
            document.querySelector('.stats').classList.add('hidden');
        }

        function checkAnswer() {
            const selected = document.querySelector('input[name="answer"]:checked');
            if (!selected) {
                alert('Pros√≠m vyberte odpovƒõƒè');
                return;
            }

            const question = selectedQuestions[currentQuestion];
            
            // Kontrola, zda ot√°zka existuje
            if (!question) {
                console.error('Ot√°zka neexistuje pro index:', currentQuestion);
                return;
            }
            
            const isCorrect = selected.value === question.correct;
            const feedbackDiv = document.querySelector('.feedback');
            const statsDiv = document.querySelector('.stats');

            feedbackDiv.classList.remove('hidden', 'correct', 'incorrect');
            feedbackDiv.classList.add(isCorrect ? 'correct' : 'incorrect');
            feedbackDiv.innerHTML = isCorrect ? 
                'Spr√°vnƒõ!' : 
                `Nespr√°vnƒõ. Spr√°vn√° odpovƒõƒè je <strong>${question.correct}</strong>.`;

            if (isCorrect) correctAnswers++;

            statsDiv.classList.remove('hidden');
            statsDiv.textContent = `Sk√≥re: ${correctAnswers} z ${currentQuestion + 1}`;

            currentQuestion++;

            if (currentQuestion < selectedQuestions.length) {
                setTimeout(showQuestion, 2000);
            } else {
                setTimeout(showResults, 2000);
            }
        }

        function showResults() {
            document.getElementById('quiz').classList.add('hidden');
            document.getElementById('results').classList.remove('hidden');
            
            const endTime = new Date();
            const duration = Math.round((endTime - startTime) / 1000);
            document.getElementById('resultsDateTime').textContent = endTime.toLocaleString('cs-CZ');
            
            const percentage = Math.round((correctAnswers / selectedQuestions.length) * 100);
            
            let performanceMessage = '';
            if (percentage >= 90) {
                performanceMessage = 'V√Ωbornƒõ! Jste expert na evropskou geografii! üèÜ';
            } else if (percentage >= 70) {
                performanceMessage = 'Velmi dob≈ôe! M√°te solidn√≠ znalosti. üëè';
            } else if (percentage >= 50) {
                performanceMessage = 'Dob≈ôe, ale je co zlep≈°ovat. üëç';
            } else {
                performanceMessage = 'Je t≈ôeba v√≠ce se uƒçit. Zkuste to znovu! üìö';
            }
            
            const modeText = quizMode === 'countryToCapital' ? 'Zemƒõ ‚Üí Hlavn√≠ mƒõsto' : 'Hlavn√≠ mƒõsto ‚Üí Zemƒõ';
            
            document.getElementById('finalStats').innerHTML = `
                <p><strong>${performanceMessage}</strong></p>
                <p>Typ kv√≠zu: <strong>${modeText}</strong></p>
                <p>Z√≠skali jste ${correctAnswers} z ${selectedQuestions.length} bod≈Ø (${percentage}%).</p>
                <p>ƒåas: ${duration} sekund</p>
                <p><em>Ka≈æd√Ω kv√≠z obsahuje 10 n√°hodnƒõ vybran√Ωch evropsk√Ωch zem√≠.</em></p>
            `;
        }

        function restartQuiz() {
            document.getElementById('results').classList.add('hidden');
            document.getElementById('intro').classList.remove('hidden');
        }
    </script>
</body>
</html>